!function(e){var t=wp.customize,n={syncDropAreas:function(){e(".header-builder .sortable").each(function(){var n=e(this).data("setting");void 0!==n&&void 0!==t.instance(n)&&t.instance(n).get()&&t.instance(n).get().forEach(function(t){var i="desktop";n.indexOf("tablet")>-1?i="tablet":n.indexOf("mobile")>-1&&(i="mobile"),e("#header-"+i+" .unused").find("[data-type="+t+"]").appendTo(".header-builder [data-setting="+n+"]")})})},makeSortable:function(){e(".header-builder .sortable").sortable({connectWith:".sortable",update:function(e,t){n.updateCustomizer(t)}}).disableSelection()},updateCustomizer:function(t){var i=null!==t.item?e(t.item).parent():t.container,a=i.data("setting"),o=[];null!==t.sender&&(i=e(t.sender),a=i.data("setting")),void 0!==a&&(i.find("span.button").each(function(){o.push(e(this).data("type"))}),n.updateSetting(a,o,"select"))},updateSetting:function(n,i,a){var o=e("[data-customize-setting-link="+n+"]");switch(a){case"switch":i="true"===i,o.prop("checked",i);break;case"radio":e("#"+n+i).prop("checked",!0);break;case"select":o.selectize()[0].selectize.setValue(i,!0);break;default:o.val(i)}t.instance(n).set(i)},updateAllArea:function(t){t.find(".sortable").each(function(){var t=e(this),i=(t.data("setting"),{container:t,item:null,sender:null});n.updateCustomizer(i)})},addTitlePanel:function(){var t=["accordion-section-top_bar","accordion-section-account_element"];t.forEach(function(t){var n=e("#sub-"+t+" .customize-section-description");e('<h3 class="section_title in-panel">'+n.text()+"</h3>").insertBefore(e("#"+t)),n.remove()})},goToSetting:function(){e("[data-section]").on("click",function(){var n=e(this).data("section");t.section(n)&&t.section(n).focus()})},deviceViews:function(){e(".header-builder .devices button").on("click",function(){var t=e(this).data("device");e("#customize-controls").find("button.preview-"+t).click()})},presetsView:function(){e(".header-builder .presets-button").on("click",function(){var t=e(this);t.toggleClass("button-primary"),e("#header-presets").toggleClass("active")})},selectPreset:function(){e("#header-presets").on("click","img",function(){var t=e(this),i=t.data("logo").split(","),a=t.data("content-pos"),o=t.data("elements").split(/\[(.*?)\]/),s=t.data("options").split(/\[(.*?)\]/),c=o.filter(function(e){return""!=e}),d=["desktop","tablet"],l=0;t.hasClass("active")||(t.addClass("active").siblings().removeClass("active"),d.forEach(function(t){e("#header-"+t).find("ul:not(.unused) .elements").each(function(){var t=e(this),n=t.closest(".customize-pane-content").find(".unused .sortable");t.appendTo(n)}),n.updateSetting("logo_position_"+t,i[l++],"select")}),c.forEach(function(t){var n=t.split(":"),i=e(".header-builder [data-setting="+n[0]+"]"),a=n[1].split(",");a.forEach(function(e){i.closest(".customize-pane-content").find(".unused [data-type="+e+"]").appendTo(i)})}),s.forEach(function(e){var t=e.split(":");e.length>0&&n.updateSetting(t[1],t[2],t[0])}),d.forEach(function(t){n.updateAllArea(e("#header-"+t))}),n.updateSetting("content_pos",a,"select"))})},displayHB:function(){t.panel("panel_header").expanded.bind(function(t){t===!0&&e(".header-builder").addClass("open")}),e(".collapse-builder").on("click",function(){e(".header-builder").toggleClass("open")})},logoPos:function(){var i=["desktop","tablet","mobile"];i.forEach(function(i){t("logo_position_"+i,function(t){t.bind(function(t){var a=e("#header-"+i),o="desktop"===i?"":"_"+i;a.removeClass("center_logo_split_menu left_logo"+o+" center_logo"+o).addClass(t),"center_logo_split_menu"===t&&"desktop"===i&&(a.find(".unused .sortable").append(a.find("[data-type=main_menu]")),n.updateAllArea(a))})})})},init:function(){n.syncDropAreas(),n.makeSortable(),n.addTitlePanel(),n.goToSetting(),n.deviceViews(),n.displayHB(),n.logoPos(),n.presetsView(),n.selectPreset()}};e(document).ready(n.init)}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbWl6ZXItcHJldmlldy5qcyJdLCJuYW1lcyI6WyIkIiwiYXBpIiwid3AiLCJjdXN0b21pemUiLCJIQiIsInN5bmNEcm9wQXJlYXMiLCJlYWNoIiwic2V0dGluZyIsInRoaXMiLCJkYXRhIiwidW5kZWZpbmVkIiwiaW5zdGFuY2UiLCJnZXQiLCJmb3JFYWNoIiwidHlwZSIsImRldmljZSIsImluZGV4T2YiLCJmaW5kIiwiYXBwZW5kVG8iLCJtYWtlU29ydGFibGUiLCJzb3J0YWJsZSIsImNvbm5lY3RXaXRoIiwidXBkYXRlIiwiZXZlbnQiLCJ1aSIsInVwZGF0ZUN1c3RvbWl6ZXIiLCJkaXNhYmxlU2VsZWN0aW9uIiwiJGNvbnRhaW5lciIsIml0ZW0iLCJwYXJlbnQiLCJjb250YWluZXIiLCJ2YWwiLCJzZW5kZXIiLCJwdXNoIiwidXBkYXRlU2V0dGluZyIsIiRzZXR0aW5nIiwicHJvcCIsInNlbGVjdGl6ZSIsInNldFZhbHVlIiwic2V0IiwidXBkYXRlQWxsQXJlYSIsIiR2aWV3IiwiYWRkVGl0bGVQYW5lbCIsInNlY3Rpb25zIiwiaWQiLCJ0aXRsZSIsInRleHQiLCJpbnNlcnRCZWZvcmUiLCJyZW1vdmUiLCJnb1RvU2V0dGluZyIsIm9uIiwic2VjdGlvbiIsImZvY3VzIiwiZGV2aWNlVmlld3MiLCJjbGljayIsInByZXNldHNWaWV3IiwiJGJ0biIsInRvZ2dsZUNsYXNzIiwic2VsZWN0UHJlc2V0IiwiJGltZyIsImxvZ29Qb3MiLCJzcGxpdCIsImNvbnRlbnRQb3MiLCJhcnJFbGVtZW50cyIsIm9wdGlvbnMiLCJuZXdFbGVtZW50cyIsImZpbHRlciIsIm4iLCJkZXZpY2VzIiwiY291bnQiLCJoYXNDbGFzcyIsImFkZENsYXNzIiwic2libGluZ3MiLCJyZW1vdmVDbGFzcyIsIiRlbCIsIiR1bnVzZWQiLCJjbG9zZXN0IiwiZWx0cyIsImFyciIsImVsZW1lbnRzIiwiZWwiLCJvcHRpb24iLCJsZW5ndGgiLCJkaXNwbGF5SEIiLCJwYW5lbCIsImV4cGFuZGVkIiwiYmluZCIsIm9wZW4iLCJ2YWx1ZSIsIm5ld3ZhbCIsIiRoZWFkZXJTZWN0aW9uIiwic3VmZml4Q2xhc3MiLCJhcHBlbmQiLCJpbml0IiwiZG9jdW1lbnQiLCJyZWFkeSIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsR0FDQSxHQUFBQyxHQUFBQyxHQUFBQyxVQUVBQyxHQUVBQyxjQUFBLFdBRUFMLEVBQUEsNkJBQUFNLEtBQUEsV0FDQSxHQUFBQyxHQUFBUCxFQUFBUSxNQUFBQyxLQUFBLFVBRUFDLFVBQUFILEdBQUFHLFNBQUFULEVBQUFVLFNBQUFKLElBQUFOLEVBQUFVLFNBQUFKLEdBQUFLLE9BQ0FYLEVBQUFVLFNBQUFKLEdBQUFLLE1BQUFDLFFBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLFNBRUFSLEdBQUFTLFFBQUEsV0FBQSxFQUNBRCxFQUFBLFNBQ0FSLEVBQUFTLFFBQUEsV0FBQSxJQUNBRCxFQUFBLFVBR0FmLEVBQUEsV0FBQWUsRUFBQSxZQUFBRSxLQUFBLGNBQUFILEVBQUEsS0FBQUksU0FBQSxpQ0FBQVgsRUFBQSxVQU9BWSxhQUFBLFdBRUFuQixFQUFBLDZCQUFBb0IsVUFDQUMsWUFBQSxZQUNBQyxPQUFBLFNBQUFDLEVBQUFDLEdBQ0FwQixFQUFBcUIsaUJBQUFELE1BRUFFLG9CQUlBRCxpQkFBQSxTQUFBRCxHQUNBLEdBQUFHLEdBQUEsT0FBQUgsRUFBQUksS0FBQTVCLEVBQUF3QixFQUFBSSxNQUFBQyxTQUFBTCxFQUFBTSxVQUNBdkIsRUFBQW9CLEVBQUFsQixLQUFBLFdBQ0FzQixJQUVBLFFBQUFQLEVBQUFRLFNBQ0FMLEVBQUEzQixFQUFBd0IsRUFBQVEsUUFDQXpCLEVBQUFvQixFQUFBbEIsS0FBQSxZQUdBQyxTQUFBSCxJQUNBb0IsRUFBQVYsS0FBQSxlQUFBWCxLQUFBLFdBQ0F5QixFQUFBRSxLQUFBakMsRUFBQVEsTUFBQUMsS0FBQSxXQUdBTCxFQUFBOEIsY0FBQTNCLEVBQUF3QixFQUFBLFlBV0FHLGNBQUEsU0FBQTNCLEVBQUF3QixF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QUFBRSxHQUNBWCxFQUFBb0MsY0FBQXhDLEVBQUEsV0FBQWUsTUFJQVgsRUFBQThCLGNBQUEsY0FBQTRCLEVBQUEsY0FLQXFCLFVBQUEsV0FFQWxGLEVBQUFtRixNQUFBLGdCQUFBQyxTQUFBQyxLQUFBLFNBQUFDLEdBQ0FBLEtBQUEsR0FDQXZGLEVBQUEsbUJBQUF1RSxTQUFBLFVBSUF2RSxFQUFBLHFCQUFBa0QsR0FBQSxRQUFBLFdBQ0FsRCxFQUFBLG1CQUFBeUQsWUFBQSxXQUtBRyxRQUFBLFdBQ0EsR0FBQVEsSUFBQSxVQUFBLFNBQUEsU0FFQUEsR0FBQXZELFFBQUEsU0FBQUUsR0FDQWQsRUFBQSxpQkFBQWMsRUFBQSxTQUFBeUUsR0FDQUEsRUFBQUYsS0FBQSxTQUFBRyxHQUNBLEdBQUFDLEdBQUExRixFQUFBLFdBQUFlLEdBQ0E0RSxFQUFBLFlBQUE1RSxFQUFBLEdBQUEsSUFBQUEsQ0FFQTJFLEdBQUFqQixZQUFBLG1DQUFBa0IsRUFBQSxlQUFBQSxHQUFBcEIsU0FBQWtCLEdBRUEsMkJBQUFBLEdBQUEsWUFBQTFFLElBQ0EyRSxFQUFBekUsS0FBQSxxQkFBQTJFLE9BQUFGLEVBQUF6RSxLQUFBLDBCQUNBYixFQUFBb0MsY0FBQWtELFdBUUFHLEtBQUEsV0FFQXpGLEVBQUFDLGdCQUNBRCxFQUFBZSxlQUNBZixFQUFBc0MsZ0JBQ0F0QyxFQUFBNkMsY0FDQTdDLEVBQUFpRCxjQUNBakQsRUFBQStFLFlBQ0EvRSxFQUFBd0QsVUFDQXhELEVBQUFtRCxjQUNBbkQsRUFBQXNELGdCQU9BMUQsR0FBQThGLFVBQUFDLE1BQUEzRixFQUFBeUYsT0FFQUciLCJmaWxlIjoiY3VzdG9taXplci1wcmV2aWV3Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkKXtcblx0dmFyIGFwaSA9IHdwLmN1c3RvbWl6ZTtcblxuXHR2YXIgSEIgPSB7XG5cblx0XHRzeW5jRHJvcEFyZWFzOiBmdW5jdGlvbigpe1xuXG5cdFx0XHQkKCAnLmhlYWRlci1idWlsZGVyIC5zb3J0YWJsZScgKS5lYWNoKCBmdW5jdGlvbigpe1xuXHRcdFx0XHR2YXIgc2V0dGluZyA9ICQoIHRoaXMgKS5kYXRhKCAnc2V0dGluZycgKTtcblxuXHRcdFx0XHRpZiAoIHNldHRpbmcgIT09IHVuZGVmaW5lZCAmJiBhcGkuaW5zdGFuY2UoIHNldHRpbmcgKSAhPT0gdW5kZWZpbmVkICYmIGFwaS5pbnN0YW5jZSggc2V0dGluZyApLmdldCgpICl7XG5cdFx0XHRcdFx0YXBpLmluc3RhbmNlKCBzZXR0aW5nICkuZ2V0KCkuZm9yRWFjaChmdW5jdGlvbiggdHlwZSApIHtcblx0XHRcdFx0XHRcdHZhciBkZXZpY2UgPSAnZGVza3RvcCc7XG5cblx0XHRcdFx0XHRcdGlmICggc2V0dGluZy5pbmRleE9mKCAndGFibGV0JyApID4gLTEgKXsgXG5cdFx0XHRcdFx0XHRcdGRldmljZSA9ICd0YWJsZXQnOyBcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIHNldHRpbmcuaW5kZXhPZiggJ21vYmlsZScgKSA+IC0xICl7IFxuXHRcdFx0XHRcdFx0XHRkZXZpY2UgPSAnbW9iaWxlJzsgXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdCQoICcjaGVhZGVyLScgKyBkZXZpY2UgKyAnIC51bnVzZWQnICkuZmluZCggJ1tkYXRhLXR5cGU9JyArIHR5cGUgKyAnXScgKS5hcHBlbmRUbyggJy5oZWFkZXItYnVpbGRlciBbZGF0YS1zZXR0aW5nPScgKyBzZXR0aW5nICsnXScgKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdH0sXG5cblx0XHRtYWtlU29ydGFibGU6IGZ1bmN0aW9uKCl7XG5cblx0XHRcdCQoICcuaGVhZGVyLWJ1aWxkZXIgLnNvcnRhYmxlJyApLnNvcnRhYmxlKHtcblx0XHQgICAgXHRjb25uZWN0V2l0aDogXCIuc29ydGFibGVcIixcblx0XHQgICAgXHR1cGRhdGU6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0ICAgIFx0XHRIQi51cGRhdGVDdXN0b21pemVyKCB1aSApO1xuXHRcdCAgICBcdH1cblx0XHQgICAgfSkuZGlzYWJsZVNlbGVjdGlvbigpO1xuXG5cdFx0fSxcblxuXHRcdHVwZGF0ZUN1c3RvbWl6ZXI6IGZ1bmN0aW9uKCB1aSApe1xuICAgICAgICAgICAgdmFyICRjb250YWluZXIgPSAoIHVpLml0ZW0gIT09IG51bGwgKSA/ICQoIHVpLml0ZW0gKS5wYXJlbnQoKSA6IHVpLmNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBzZXR0aW5nID0gJGNvbnRhaW5lci5kYXRhKCAnc2V0dGluZycgKSxcblx0XHRcdFx0dmFsID0gW107XG5cdFx0XHRcblx0XHRcdGlmICggdWkuc2VuZGVyICE9PSBudWxsICkge1xuXHRcdFx0XHQkY29udGFpbmVyID0gJCggdWkuc2VuZGVyICk7XG5cdFx0XHRcdHNldHRpbmcgPSAkY29udGFpbmVyLmRhdGEoICdzZXR0aW5nJyApO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIHNldHRpbmcgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0JGNvbnRhaW5lci5maW5kKCAnc3Bhbi5idXR0b24nICkuZWFjaCggZnVuY3Rpb24oKXtcblx0XHRcdFx0XHR2YWwucHVzaCggJCggdGhpcyApLmRhdGEoICd0eXBlJyApICk7XG5cdFx0XHRcdH0pO1xuXG4gICAgICAgICAgICAgICAgSEIudXBkYXRlU2V0dGluZyggc2V0dGluZywgdmFsLCAnc2VsZWN0JyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEaXNwbGF5L0hpZGUgTWVudSBQb3NpdG9uIG9wdGlvbiBmcm9tIGN1c3RvbWl6ZXJcblx0XHRcdC8vIGlmICggJCggJy5oZWFkZXItYnVpbGRlciAubWFpbi1oZWFkZXInICkuZmluZCggJy5idXR0b25bZGF0YS10eXBlPVwibWFpbl9tZW51XCJdJyApLmxlbmd0aCA9PSAwICkge1xuXHRcdFx0Ly8gXHQkKCAnW2RhdGEtY3VzdG9taXplLXNldHRpbmctbGluaz1cImNvbnRlbnRfcG9zXCJdJyApLnNlbGVjdGl6ZSgpWzBdLnNlbGVjdGl6ZS5zZXRWYWx1ZSggJ2xlZnQnLCAhMCApO1xuXHRcdFx0Ly8gXHRhcGkuaW5zdGFuY2UoICdjb250ZW50X3BvcycgKS5zZXQoICdsZWZ0JyApO1xuXHRcdFx0Ly8gfVxuXHRcblx0XHR9LFxuXG5cdFx0dXBkYXRlU2V0dGluZzogZnVuY3Rpb24oIHNldHRpbmcsIHZhbCwgdHlwZSApe1xuXHRcdCAgICB2YXIgJHNldHRpbmcgPSAkKCAnW2RhdGEtY3VzdG9taXplLXNldHRpbmctbGluaz0nICsgc2V0dGluZyArICddJyApO1xuXG5cdFx0ICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N3aXRjaCc6XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9ICggdmFsID09PSAndHJ1ZScgPyB0cnVlIDogZmFsc2UgKTtcblxuICAgICAgICAgICAgICAgICAgICAkc2V0dGluZy5wcm9wKCAnY2hlY2tlZCcsIHZhbCApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdyYWRpbyc6XG4gICAgICAgICAgICAgICAgICAgICQoICcjJyArIHNldHRpbmcgKyB2YWwgKS5wcm9wKCAnY2hlY2tlZCcsIHRydWUgKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0JzpcbiAgICAgICAgICAgICAgICAgICAgJHNldHRpbmcuc2VsZWN0aXplKClbMF0uc2VsZWN0aXplLnNldFZhbHVlKCB2YWwsICEwICk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICRzZXR0aW5nLnZhbCggdmFsICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFwaS5pbnN0YW5jZSggc2V0dGluZyApLnNldCggdmFsICk7XG5cdFx0fSxcblxuICAgICAgICB1cGRhdGVBbGxBcmVhOiBmdW5jdGlvbiggJHZpZXcgKXtcbiAgICAgICAgICAgICR2aWV3LmZpbmQoICcuc29ydGFibGUnICkuZWFjaCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyICRjb250YWluZXIgPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmcgPSAkY29udGFpbmVyLmRhdGEoICdzZXR0aW5nJyApLFxuICAgICAgICAgICAgICAgICAgICB1aSA9IHsgY29udGFpbmVyOiAkY29udGFpbmVyLCBpdGVtOiBudWxsLCBzZW5kZXI6IG51bGwgfTtcblxuICAgICAgICAgICAgICAgIEhCLnVwZGF0ZUN1c3RvbWl6ZXIoIHVpICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuXHRcdGFkZFRpdGxlUGFuZWw6IGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgc2VjdGlvbnMgPSBbJ2FjY29yZGlvbi1zZWN0aW9uLXRvcF9iYXInLCAnYWNjb3JkaW9uLXNlY3Rpb24tYWNjb3VudF9lbGVtZW50J107XG5cblx0XHRcdHNlY3Rpb25zLmZvckVhY2goIGZ1bmN0aW9uKCBpZCApe1xuXHRcdFx0XHR2YXIgdGl0bGUgPSAkKCAnI3N1Yi0nICsgaWQgKyAnIC5jdXN0b21pemUtc2VjdGlvbi1kZXNjcmlwdGlvbicgKTtcblxuXHRcdFx0XHQkKCAnPGgzIGNsYXNzPVwic2VjdGlvbl90aXRsZSBpbi1wYW5lbFwiPicgKyB0aXRsZS50ZXh0KCkgKyAnPC9oMz4nICkuaW5zZXJ0QmVmb3JlKCAkKCAnIycgKyBpZCApICk7XG5cblx0XHRcdFx0dGl0bGUucmVtb3ZlKCk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0Z29Ub1NldHRpbmc6IGZ1bmN0aW9uKCl7XG5cblx0XHRcdCQoICdbZGF0YS1zZWN0aW9uXScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIHNlY3Rpb24gPSAkKCB0aGlzICkuZGF0YSggJ3NlY3Rpb24nICk7XG5cblx0XHRcdFx0aWYgKCBhcGkuc2VjdGlvbiggc2VjdGlvbiApICl7XG5cdFx0XHRcdFx0YXBpLnNlY3Rpb24oIHNlY3Rpb24gKS5mb2N1cygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdH0sXG5cbiAgICAgICAgZGV2aWNlVmlld3M6IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICQoICcuaGVhZGVyLWJ1aWxkZXIgLmRldmljZXMgYnV0dG9uJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHZhciBkZXZpY2UgPSAkKCB0aGlzICkuZGF0YSggJ2RldmljZScgKTtcblxuICAgICAgICAgICAgICAgICQoICcjY3VzdG9taXplLWNvbnRyb2xzJykuZmluZCggJ2J1dHRvbi5wcmV2aWV3LScgKyBkZXZpY2UgKS5jbGljaygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBwcmVzZXRzVmlldzogZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgJCggJy5oZWFkZXItYnVpbGRlciAucHJlc2V0cy1idXR0b24nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyICRidG4gPSAkKCB0aGlzICk7XG5cbiAgICAgICAgICAgICAgICAkYnRuLnRvZ2dsZUNsYXNzKCAnYnV0dG9uLXByaW1hcnknICk7XG4gICAgICAgICAgICAgICAgJCggJyNoZWFkZXItcHJlc2V0cycgKS50b2dnbGVDbGFzcyggJ2FjdGl2ZScgKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZWxlY3RQcmVzZXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkKCAnI2hlYWRlci1wcmVzZXRzJyApLm9uKCAnY2xpY2snLCAnaW1nJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB2YXIgJGltZyA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgbG9nb1BvcyA9ICRpbWcuZGF0YSggJ2xvZ28nICkuc3BsaXQoICcsJyApLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50UG9zID0gJGltZy5kYXRhKCAnY29udGVudC1wb3MnICksXG4gICAgICAgICAgICAgICAgICAgIGFyckVsZW1lbnRzID0gJGltZy5kYXRhKCAnZWxlbWVudHMnICkuc3BsaXQoL1xcWyguKj8pXFxdLyksXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSAkaW1nLmRhdGEoICdvcHRpb25zJyApLnNwbGl0KC9cXFsoLio/KVxcXS8pLFxuICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50cyA9IGFyckVsZW1lbnRzLmZpbHRlciggZnVuY3Rpb24obil7IHJldHVybiBuICE9IFwiXCIgfSApLFxuICAgICAgICAgICAgICAgICAgICBkZXZpY2VzID0gWyAnZGVza3RvcCcsICd0YWJsZXQnIF0sXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMDtcblxuICAgICAgICAgICAgICAgIGlmICggISAkaW1nLmhhc0NsYXNzKCAnYWN0aXZlJyApICl7XG4gICAgICAgICAgICAgICAgICAgICRpbWcuYWRkQ2xhc3MoICdhY3RpdmUnICkuc2libGluZ3MoKS5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcblxuICAgICAgICAgICAgICAgICAgICBkZXZpY2VzLmZvckVhY2goIGZ1bmN0aW9uKCBkZXZpY2UgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbXB0eSBhbGwgZWxlbWVudHMgaW4gZGVza3RvcCBhbmQgdGFibGV0XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCAnI2hlYWRlci0nICsgZGV2aWNlICkuZmluZCgndWw6bm90KC51bnVzZWQpIC5lbGVtZW50cycpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZWwgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdW51c2VkID0gJGVsLmNsb3Nlc3QoJy5jdXN0b21pemUtcGFuZS1jb250ZW50JykuZmluZCgnLnVudXNlZCAuc29ydGFibGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlbC5hcHBlbmRUbygkdW51c2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZWxlY3RpbmcgdGhlIGxvZ28gcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIEhCLnVwZGF0ZVNldHRpbmcoICdsb2dvX3Bvc2l0aW9uXycgKyBkZXZpY2UsIGxvZ29Qb3NbY291bnQrK10sICdzZWxlY3QnICk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZGluZyBlbGVtZW50cyBmcm9tIHRoZSBwcmVzZXRcbiAgICAgICAgICAgICAgICAgICAgbmV3RWxlbWVudHMuZm9yRWFjaCggZnVuY3Rpb24oIGVsdHMgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcnIgPSBlbHRzLnNwbGl0KCAnOicgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2V0dGluZyA9ICQoICcuaGVhZGVyLWJ1aWxkZXIgW2RhdGEtc2V0dGluZz0nICsgYXJyWzBdICsnXScgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50cyA9IGFyclsxXS5zcGxpdCggJywnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLmZvckVhY2goIGZ1bmN0aW9uKCBlbCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZXR0aW5nLmNsb3Nlc3QoICcuY3VzdG9taXplLXBhbmUtY29udGVudCcgKS5maW5kKCAnLnVudXNlZCBbZGF0YS10eXBlPScgKyBlbCArICddJyApLmFwcGVuZFRvKCAkc2V0dGluZyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hhbmdpbmcgb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmZvckVhY2goIGZ1bmN0aW9uKCBvcHRpb24gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJyID0gb3B0aW9uLnNwbGl0KCAnOicgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBvcHRpb24ubGVuZ3RoID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIQi51cGRhdGVTZXR0aW5nKCBhcnJbMV0sIGFyclsyXSwgYXJyWzBdICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRldmljZXMuZm9yRWFjaCggZnVuY3Rpb24oIGRldmljZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEhCLnVwZGF0ZUFsbEFyZWEoICQoJyNoZWFkZXItJyArIGRldmljZSApICk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNlbGVjdGluZyB0aGUgY29udGVudCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICBIQi51cGRhdGVTZXR0aW5nKCAnY29udGVudF9wb3MnLCBjb250ZW50UG9zLCAnc2VsZWN0JyApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG5cdFx0ZGlzcGxheUhCOiBmdW5jdGlvbigpe1xuXG5cdFx0XHRhcGkucGFuZWwoICdwYW5lbF9oZWFkZXInICkuZXhwYW5kZWQuYmluZCggZnVuY3Rpb24oIG9wZW4gKXtcbiAgICAgICAgICAgIFx0aWYgKCBvcGVuID09PSB0cnVlICl7XG4gICAgICAgICAgICBcdFx0JCggJy5oZWFkZXItYnVpbGRlcicgKS5hZGRDbGFzcyggJ29wZW4nICk7XG4gICAgICAgICAgICBcdH1cbiAgICAgICAgICAgIH0pO1xuXG5cdFx0XHQkKCAnLmNvbGxhcHNlLWJ1aWxkZXInICkub24oICdjbGljaycsIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCQoICcuaGVhZGVyLWJ1aWxkZXInICkudG9nZ2xlQ2xhc3MoICdvcGVuJyApO1xuXHRcdFx0fSk7XG5cblx0XHR9LFxuXG5cdFx0bG9nb1BvczogZnVuY3Rpb24oKXtcblx0XHRcdHZhciBkZXZpY2VzID0gWyAnZGVza3RvcCcsICd0YWJsZXQnLCAnbW9iaWxlJyBdO1xuXG5cdFx0XHRkZXZpY2VzLmZvckVhY2goIGZ1bmN0aW9uKCBkZXZpY2UgKXtcblx0XHRcdFx0YXBpKCAnbG9nb19wb3NpdGlvbl8nICsgZGV2aWNlLCBmdW5jdGlvbiggdmFsdWUgKXtcblx0XHRcdFx0XHR2YWx1ZS5iaW5kKCBmdW5jdGlvbiggbmV3dmFsICkge1xuXHRcdCAgICAgICAgICAgIFx0dmFyICRoZWFkZXJTZWN0aW9uID0gJCggJyNoZWFkZXItJyArIGRldmljZSApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1ZmZpeENsYXNzID0gKCBkZXZpY2UgPT09ICdkZXNrdG9wJyA/ICcnIDogJ18nICsgZGV2aWNlICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICRoZWFkZXJTZWN0aW9uLnJlbW92ZUNsYXNzKCAnY2VudGVyX2xvZ29fc3BsaXRfbWVudSBsZWZ0X2xvZ28nICsgc3VmZml4Q2xhc3MgKyAnIGNlbnRlcl9sb2dvJyArIHN1ZmZpeENsYXNzICkuYWRkQ2xhc3MoIG5ld3ZhbCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG5ld3ZhbCA9PT0gJ2NlbnRlcl9sb2dvX3NwbGl0X21lbnUnICYmIGRldmljZSA9PT0gJ2Rlc2t0b3AnICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGhlYWRlclNlY3Rpb24uZmluZCggJy51bnVzZWQgLnNvcnRhYmxlJykuYXBwZW5kKCAkaGVhZGVyU2VjdGlvbi5maW5kKCAnW2RhdGEtdHlwZT1tYWluX21lbnVdJyApICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSEIudXBkYXRlQWxsQXJlYSggJGhlYWRlclNlY3Rpb24gKTtcblx0XHRcdFx0XHRcdH1cblx0XHQgICAgICAgICAgICB9KTtcblx0XHQgICAgICAgIH0pO1xuXHRcdCAgICB9KTtcblxuXHRcdH0sXG5cblx0XHRpbml0OiBmdW5jdGlvbigpe1xuXG5cdFx0XHRIQi5zeW5jRHJvcEFyZWFzKCk7XG5cdFx0XHRIQi5tYWtlU29ydGFibGUoKTtcblx0XHRcdEhCLmFkZFRpdGxlUGFuZWwoKTtcblx0XHRcdEhCLmdvVG9TZXR0aW5nKCk7XG5cdFx0XHRIQi5kZXZpY2VWaWV3cygpO1xuXHRcdFx0SEIuZGlzcGxheUhCKCk7XG5cdFx0XHRIQi5sb2dvUG9zKCk7XG5cdFx0XHRIQi5wcmVzZXRzVmlldygpO1xuXHRcdFx0SEIuc2VsZWN0UHJlc2V0KCk7XG5cblx0XHR9XG5cblx0fTtcblxuXHQvLyBMb2FkIEV2ZW50c1xuXHQkKCBkb2N1bWVudCApLnJlYWR5KCBIQi5pbml0ICk7XG5cbn0pKGpRdWVyeSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
