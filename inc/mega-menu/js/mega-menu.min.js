var menuSettings;!function(e,t){"use strict";var a;a=menuSettings={init:function(){a.$body=e("body"),a.$modal=e("#menu-modal"),a.itemData={},a.templates={menus:t.template(e("#pp-tmpl-menus").html()),title:t.template(e("#pp-tmpl-title").html()),mega:t.template(e("#pp-tmpl-mega").html()),background:t.template(e("#pp-tmpl-background").html()),icon:t.template(e("#pp-tmpl-icon").html()),content:t.template(e("#pp-tmpl-content").html()),general:t.template(e("#pp-tmpl-general").html())},a.frame=wp.media({library:{type:"image"}}),this.initActions()},initActions:function(){a.$body.on("click",".opensettings",this.openModal).on("click",".mega-modal-backdrop, .mega-modal-close, .pp-button-cancel",this.closeModal),a.$modal.on("click",".pp-mega-menu-item-setting-tab a",this.switchPanel).on("click",".item-controls span",this.resizeMegaColumn).on("click",".pp-button-save",this.saveChanges)},openModal:function(){return a.getItemData(this),a.$modal.show(),a.$body.addClass("modal-open"),a.render(this),!1},closeModal:function(){return a.$modal.hide().find(".pp-menu-item-tab-content").html(""),a.$body.removeClass("modal-open"),!1},switchPanel:function(t){t.preventDefault();var i=e(this).parent(),n=i.data("panel");i.addClass("active-item-setting-tab").siblings(".active-item-setting-tab").removeClass("active-item-setting-tab"),a.openSettings(n)},render:function(t){var i=this;a.$modal.find(".pp-mega-menu-item-setting-tabs").html(a.templates.menus(a.itemData));var n=a.$modal.find(".pp-mega-menu-item-setting-tabs .pp-mega-menu-to-content"),d=e(t).parents(".menu-item-settings").find("input.edit-menu-item-title").val();a.$modal.find(".pp-mega-menu-item-header-bar").html(a.templates.title({title:d})),n.each(function(){i.openSettings(e(this).data("panel"))})},openSettings:function(e){var t=a.$modal.find(".pp-menu-item-tab-content"),i=t.children("#inside-"+e);if(i.length)i.addClass("active").siblings().removeClass("active");else{var n=a.$modal.find(".pp-mega-menu-item-setting-tabs .pp-mega-menu-to-content[data-panel="+e+"]");t.append(a.templates[e](a.itemData)),n.hasClass("active-item-setting-tab")&&t.children("#inside-"+e).addClass("active").siblings().removeClass("active"),"mega"==e&&a.initMegaColumns(),"background"==e&&a.initBackgroundFields(),"icon"==e&&a.initIconFields()}},resizeMegaColumn:function(a){a.preventDefault();var i,n=["20.00%","25.00%","33.33%","50.00%","66.66%","75.00%","100.00%"],d=e(this),o=d.closest(".menu-item-container"),m=o.data("width"),s=t.indexOf(n,m);-1!==s&&(i=d.hasClass("submenu-bigger")?s==n.length?s:s+1:0==s?s:s-1,o[0].style.width=n[i],o.data("width",n[i]),o.find(".menu-item-handle .menu-item-width").val(n[i]))},initMegaColumns:function(){var i=a.$modal.find("#inside-mega .menu-item-container"),n="25.00%";i.length&&(i.length<4&&(n=String((100/i.length).toFixed(2))+"%"),t.each(i,function(t){var a=t.dataset.width;a=a||n,t.style.width=a,t.dataset.width=a,e(t).find(".menu-item-handle .menu-item-width").val(a)}))},initBackgroundFields:function(){a.$modal.find(".background-color-picker").wpColorPicker(),a.$modal.on("click",".item-media .upload-button",function(t){t.preventDefault();var i=e(this);a.frame.off("select"),a.frame.on("select",function(){var e=a.frame.state().get("selection").first().toJSON().url;i.siblings(".thumbnail-image").html('<img src="'+e+'">'),i.siblings("input").val(e),i.addClass("hidden"),i.siblings(".remove-button").removeClass("hidden")}),a.frame.open()}).on("click",".item-media .remove-button",function(t){t.preventDefault();var a=e(this);a.siblings(".thumbnail-image").html(""),a.siblings("input").val(""),a.addClass("hidden"),a.siblings(".upload-button").removeClass("hidden")}),a.$modal.on("change",".image-size select",function(){var t=e(this),a=t.parents(".inside-background");"background"==t.val()?(a.find(".background-position, .background-repeat, .background-size").removeClass("hidden"),a.find(".image-position, .image-margin").addClass("hidden")):(a.find(".background-position, .background-repeat, .background-size").addClass("hidden"),a.find(".image-position, .image-margin").removeClass("hidden"))})},initIconFields:function(){var t=a.$modal.find("#pp-icon-input"),i=a.$modal.find(".pp-icon-selector .selected-icon"),n=a.$modal.find(".pp-icon-selector .icons-content i");a.$modal.on("click",".pp-icon-selector .icons-content span",function(){var a=e(this),n=a.find("i").data("icon");e(".pp-icon-selector .icons-content span.active").removeClass("active"),a.addClass("active"),t.val(n),i.html('<i class="'+n+'"></i>')}),a.$modal.on("click",".pp-icon-selector .remove-icon",function(){i.html(""),t.val("")}),a.$modal.on("click",".pp-icon-selector .icons-tab",function(){var t=e(this),a=e(".pp-icon-selector .icons-content."+t.data("tab"));t.hasClass("active")||(t.addClass("active").siblings(".active").removeClass("active"),a.addClass("active").siblings(".active").removeClass("active"))}),a.$modal.on("keyup",".pp-icon-search",function(t){var a=e(this).val().toUpperCase(),i=n.parent();a?i.hide().filter(function(){return e(this).find("i").data("icon").toUpperCase().indexOf(a)>-1}).show():i.show()})},getItemData:function(i){var n=e(i).closest("li.menu-item"),d=n.find(".pp-data"),o=n.childMenuItems();a.itemData={depth:n.menuItemDepth(),megaData:{mega:d.data("mega"),mega_width:d.data("mega_width"),width:d.data("width"),background:d.data("background"),img_type:d.data("img_type"),img_size:d.data("img_size"),img_pos:d.data("img_pos"),img_no_margin:d.data("img_no_margin"),icon:d.data("icon"),icon_pos:d.data("icon_pos"),hide_text:d.data("hide_text"),hide_desktop:d.data("hide_desktop"),hide_mobile:d.data("hide_mobile"),hide_img_desktop:d.data("hide_img_desktop"),hide_img_mobile:d.data("hide_img_mobile"),hot:d.data("hot"),uppercase_text:d.data("uppercase_text"),new:d.data("new"),trending:d.data("trending"),sale:d.data("sale"),disable_link:d.data("disable_link"),content:d.html()},data:n.getItemData(),children:[],originalElement:n.get(0)},t.isEmpty(o)||t.each(o,function(t){var i=e(t),n=i.find(".pp-data"),d=i.menuItemDepth();a.itemData.children.push({depth:d,subDepth:d-a.itemData.depth-1,data:i.getItemData(),megaData:{mega:n.data("mega"),mega_width:n.data("mega_width"),width:n.data("width"),background:n.data("background"),img_type:n.data("img_type"),img_size:n.data("img_size"),img_pos:n.data("img_pos"),img_no_margin:n.data("img_no_margin"),icon:n.data("icon"),icon_pos:n.data("icon_pos"),hide_text:n.data("hide_text"),hide_desktop:n.data("hide_desktop"),hide_mobile:n.data("hide_mobile"),hide_img_desktop:n.data("hide_img_desktop"),hide_img_mobile:n.data("hide_img_mobile"),hot:n.data("hot"),uppercase_text:n.data("uppercase_text"),new:n.data("new"),trending:n.data("trending"),sale:n.data("sale"),disable_link:n.data("disable_link"),content:n.html()},originalElement:t})})},setItemData:function(a,i,n){var d=["mega","hide_text","uppercase_text","disable_link","img_no_margin","hide_desktop","hide_mobile","hot","new","trending","sale","hide_img_desktop","hide_img_mobile"];e.each(d,function(e,a){t.has(i,a)||(i[a]=!1)});var o=e(a).find(".pp-data");t.has(i,"content")&&(o.html(i.content),delete i.content),o.data(i)},getFieldName:function(e,t){return e=e.split("."),e="["+e.join("][")+"]","menu-item["+t+"]"+e},saveChanges:function(){var i=a.$modal.find(".pp-menu-item-tab-content :input").serialize(),n=a.$modal.find(".pp-mega-menu-item-controls .spinner");return n.addClass("is-active"),e.post(ajaxurl,{action:"pp_save_menu_item_data",data:i},function(e){if(e.success){var i=e.data["menu-item"];t.has(i,a.itemData.data["menu-item-db-id"])&&a.setItemData(a.itemData.originalElement,i[a.itemData.data["menu-item-db-id"]],0),t.each(a.itemData.children,function(e){t.has(i,e.data["menu-item-db-id"])&&a.setItemData(e.originalElement,i[e.data["menu-item-db-id"]],1)}),n.removeClass("is-active"),a.closeModal()}}),!1}},e(function(){menuSettings.init()})}(jQuery,_);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZ2EtbWVudS5qcyJdLCJuYW1lcyI6WyJtZW51U2V0dGluZ3MiLCIkIiwiXyIsIm9wdGlvbnMiLCJpbml0IiwiJGJvZHkiLCIkbW9kYWwiLCJpdGVtRGF0YSIsInRlbXBsYXRlcyIsIm1lbnVzIiwidGVtcGxhdGUiLCJodG1sIiwidGl0bGUiLCJtZWdhIiwiYmFja2dyb3VuZCIsImljb24iLCJjb250ZW50IiwiZ2VuZXJhbCIsImZyYW1lIiwid3AiLCJtZWRpYSIsImxpYnJhcnkiLCJ0eXBlIiwidGhpcyIsImluaXRBY3Rpb25zIiwib24iLCJvcGVuTW9kYWwiLCJjbG9zZU1vZGFsIiwic3dpdGNoUGFuZWwiLCJyZXNpemVNZWdhQ29sdW1uIiwic2F2ZUNoYW5nZXMiLCJnZXRJdGVtRGF0YSIsInNob3ciLCJhZGRDbGFzcyIsInJlbmRlciIsImhpZGUiLCJmaW5kIiwicmVtb3ZlQ2xhc3MiLCJlIiwicHJldmVudERlZmF1bHQiLCIkZWwiLCJwYXJlbnQiLCJwYW5lbCIsImRhdGEiLCJzaWJsaW5ncyIsIm9wZW5TZXR0aW5ncyIsIm1lbnVJdGVtIiwiX3RoaXMiLCIkbWVudVBhbmVscyIsInBhcmVudHMiLCJ2YWwiLCJlYWNoIiwiJGNvbnRlbnQiLCIkcGFuZWwiLCJjaGlsZHJlbiIsImxlbmd0aCIsIiR0YWJQYW5lbCIsImFwcGVuZCIsImhhc0NsYXNzIiwiaW5pdE1lZ2FDb2x1bW5zIiwiaW5pdEJhY2tncm91bmRGaWVsZHMiLCJpbml0SWNvbkZpZWxkcyIsIm5leHQiLCJzdGVwcyIsIiRjb2x1bW4iLCJjbG9zZXN0Iiwid2lkdGgiLCJjdXJyZW50IiwiaW5kZXhPZiIsInN0eWxlIiwiJGNvbHVtbnMiLCJkZWZhdWx0V2lkdGgiLCJTdHJpbmciLCJ0b0ZpeGVkIiwiY29sdW1uIiwiZGF0YXNldCIsIndwQ29sb3JQaWNrZXIiLCJvZmYiLCJ1cmwiLCJzdGF0ZSIsImdldCIsImZpcnN0IiwidG9KU09OIiwib3BlbiIsIiRjb250YWluZXIiLCIkaW5wdXQiLCIkcHJldmlldyIsIiRpY29ucyIsIiR0YXJnZXQiLCJ0ZXJtIiwidG9VcHBlckNhc2UiLCIkaWNvbkNvbnRhaW5lciIsImZpbHRlciIsIiRtZW51SXRlbSIsIiRtZW51RGF0YSIsImNoaWxkTWVudUl0ZW1zIiwiZGVwdGgiLCJtZW51SXRlbURlcHRoIiwibWVnYURhdGEiLCJtZWdhX3dpZHRoIiwiaW1nX3R5cGUiLCJpbWdfc2l6ZSIsImltZ19wb3MiLCJpbWdfbm9fbWFyZ2luIiwiaWNvbl9wb3MiLCJoaWRlX3RleHQiLCJoaWRlX2Rlc2t0b3AiLCJoaWRlX21vYmlsZSIsImhpZGVfaW1nX2Rlc2t0b3AiLCJoaWRlX2ltZ19tb2JpbGUiLCJob3QiLCJ1cHBlcmNhc2VfdGV4dCIsIm5ldyIsInRyZW5kaW5nIiwic2FsZSIsImRpc2FibGVfbGluayIsIm9yaWdpbmFsRWxlbWVudCIsImlzRW1wdHkiLCJpdGVtIiwiJGl0ZW0iLCIkaXRlbURhdGEiLCJwdXNoIiwic3ViRGVwdGgiLCJzZXRJdGVtRGF0YSIsImNoZWNrYm94ZXMiLCJpbmRleCIsInZhbHVlIiwiaGFzIiwiJGRhdGFIb2xkZXIiLCJnZXRGaWVsZE5hbWUiLCJuYW1lIiwiaWQiLCJzcGxpdCIsImpvaW4iLCJzZXJpYWxpemUiLCIkc3Bpbm5lciIsInBvc3QiLCJhamF4dXJsIiwiYWN0aW9uIiwicmVzIiwic3VjY2VzcyIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsZUFFQSxTQUFBQyxFQUFBQyxHQUNBLFlBRUEsSUFBQUMsRUFDQUEsR0FBQUgsY0FDQUksS0FBQSxXQUNBRCxFQUFBRSxNQUFBSixFQUFBLFFBQ0FFLEVBQUFHLE9BQUFMLEVBQUEsZUFDQUUsRUFBQUksWUFDQUosRUFBQUssV0FDQUMsTUFBQVAsRUFBQVEsU0FBQVQsRUFBQSxrQkFBQVUsUUFDQUMsTUFBQVYsRUFBQVEsU0FBQVQsRUFBQSxrQkFBQVUsUUFDQUUsS0FBQVgsRUFBQVEsU0FBQVQsRUFBQSxpQkFBQVUsUUFDQUcsV0FBQVosRUFBQVEsU0FBQVQs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QUFwRixFQUFBbUYsS0FDQW5GLEVBQUFtRixJQUFBLElBSUEsSUFBQUUsR0FBQS9ILEVBQUFxSCxHQUFBbEYsS0FBQSxXQUVBbEMsR0FBQTZILElBQUFwRixFQUFBLGFBQ0FxRixFQUFBckgsS0FBQWdDLEVBQUEzQixlQUNBMkIsR0FBQTNCLFNBR0FnSCxFQUFBckYsS0FBQUEsSUFJQXNGLGFBQUEsU0FBQUMsRUFBQUMsR0FJQSxNQUhBRCxHQUFBQSxFQUFBRSxNQUFBLEtBQ0FGLEVBQUEsSUFBQUEsRUFBQUcsS0FBQSxNQUFBLElBRUEsYUFBQUYsRUFBQSxJQUFBRCxHQUdBcEcsWUFBQSxXQUNBLEdBQUFhLEdBQUF4QyxFQUFBRyxPQUFBOEIsS0FBQSxvQ0FBQWtHLFlBQ0FDLEVBQUFwSSxFQUFBRyxPQUFBOEIsS0FBQSx1Q0ErQkEsT0E3QkFtRyxHQUFBdEcsU0FBQSxhQUVBaEMsRUFBQXVJLEtBQUFDLFNBQ0FDLE9BQUEseUJBQ0EvRixLQUFBQSxHQUNBLFNBQUFnRyxHQUNBLEdBQUFBLEVBQUFDLFFBQUEsQ0FJQSxHQUFBakcsR0FBQWdHLEVBQUFoRyxLQUFBLFlBR0F6QyxHQUFBNkgsSUFBQXBGLEVBQUF4QyxFQUFBSSxTQUFBb0MsS0FBQSxxQkFDQXhDLEVBQUF3SCxZQUFBeEgsRUFBQUksU0FBQTZHLGdCQUFBekUsRUFBQXhDLEVBQUFJLFNBQUFvQyxLQUFBLG9CQUFBLEdBR0F6QyxFQUFBaUQsS0FBQWhELEVBQUFJLFNBQUErQyxTQUFBLFNBQUFSLEdBQ0E1QyxFQUFBNkgsSUFBQXBGLEVBQUFHLEVBQUFILEtBQUEscUJBSUF4QyxFQUFBd0gsWUFBQTdFLEVBQUFzRSxnQkFBQXpFLEVBQUFHLEVBQUFILEtBQUEsb0JBQUEsS0FHQTRGLEVBQUFsRyxZQUFBLGFBQ0FsQyxFQUFBd0IsaUJBR0EsSUFJQTFCLEVBQUEsV0FDQUQsYUFBQUksVUFFQXlJLE9BQUEzSSIsImZpbGUiOiJtZWdhLW1lbnUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG1lbnVTZXR0aW5ncztcclxuXHJcbihmdW5jdGlvbiAoJCwgXykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHJcblx0dmFyIG9wdGlvbnM7XHJcblx0b3B0aW9ucyA9IG1lbnVTZXR0aW5ncyA9IHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0b3B0aW9ucy4kYm9keSA9ICQoJ2JvZHknKTtcclxuXHRcdFx0b3B0aW9ucy4kbW9kYWwgPSAkKCcjbWVudS1tb2RhbCcpO1xyXG5cdFx0XHRvcHRpb25zLml0ZW1EYXRhID0ge307XHJcblx0XHRcdG9wdGlvbnMudGVtcGxhdGVzID0ge1xyXG5cdFx0XHRcdG1lbnVzICAgICA6IF8udGVtcGxhdGUoJCgnI3BwLXRtcGwtbWVudXMnKS5odG1sKCkpLFxyXG5cdFx0XHRcdHRpdGxlICAgICA6IF8udGVtcGxhdGUoJCgnI3BwLXRtcGwtdGl0bGUnKS5odG1sKCkpLFxyXG5cdFx0XHRcdG1lZ2EgICAgICA6IF8udGVtcGxhdGUoJCgnI3BwLXRtcGwtbWVnYScpLmh0bWwoKSksXHJcblx0XHRcdFx0YmFja2dyb3VuZDogXy50ZW1wbGF0ZSgkKCcjcHAtdG1wbC1iYWNrZ3JvdW5kJykuaHRtbCgpKSxcclxuXHRcdFx0XHRpY29uICAgICAgOiBfLnRlbXBsYXRlKCQoJyNwcC10bXBsLWljb24nKS5odG1sKCkpLFxyXG5cdFx0XHRcdGNvbnRlbnQgICA6IF8udGVtcGxhdGUoJCgnI3BwLXRtcGwtY29udGVudCcpLmh0bWwoKSksXHJcblx0XHRcdFx0Z2VuZXJhbCAgIDogXy50ZW1wbGF0ZSgkKCcjcHAtdG1wbC1nZW5lcmFsJykuaHRtbCgpKVxyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0b3B0aW9ucy5mcmFtZSA9IHdwLm1lZGlhKHtcclxuXHRcdFx0XHRsaWJyYXJ5OiB7XHJcblx0XHRcdFx0XHR0eXBlOiAnaW1hZ2UnXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHRoaXMuaW5pdEFjdGlvbnMoKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0aW5pdEFjdGlvbnM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0b3B0aW9ucy4kYm9keVxyXG5cdFx0XHRcdC5vbignY2xpY2snLCAnLm9wZW5zZXR0aW5ncycsIHRoaXMub3Blbk1vZGFsKVxyXG5cdFx0XHRcdC5vbignY2xpY2snLCAnLm1lZ2EtbW9kYWwtYmFja2Ryb3AsIC5tZWdhLW1vZGFsLWNsb3NlLCAucHAtYnV0dG9uLWNhbmNlbCcsIHRoaXMuY2xvc2VNb2RhbCk7XHJcblxyXG5cdFx0XHRvcHRpb25zLiRtb2RhbFxyXG5cdFx0XHRcdC5vbignY2xpY2snLCAnLnBwLW1lZ2EtbWVudS1pdGVtLXNldHRpbmctdGFiIGEnLCB0aGlzLnN3aXRjaFBhbmVsKVxyXG5cdFx0XHRcdC5vbignY2xpY2snLCAnLml0ZW0tY29udHJvbHMgc3BhbicsIHRoaXMucmVzaXplTWVnYUNvbHVtbilcclxuXHRcdFx0XHQub24oJ2NsaWNrJywgJy5wcC1idXR0b24tc2F2ZScsIHRoaXMuc2F2ZUNoYW5nZXMpO1xyXG5cdFx0fSxcclxuXHJcblx0XHRvcGVuTW9kYWw6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0b3B0aW9ucy5nZXRJdGVtRGF0YSh0aGlzKTtcclxuXHJcblx0XHRcdG9wdGlvbnMuJG1vZGFsLnNob3coKTtcclxuXHRcdFx0b3B0aW9ucy4kYm9keS5hZGRDbGFzcygnbW9kYWwtb3BlbicpO1xyXG5cdFx0XHRvcHRpb25zLnJlbmRlcih0aGlzKTtcclxuXHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH0sXHJcblxyXG5cdFx0Y2xvc2VNb2RhbDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRvcHRpb25zLiRtb2RhbC5oaWRlKCkuZmluZCgnLnBwLW1lbnUtaXRlbS10YWItY29udGVudCcpLmh0bWwoJycpO1xyXG5cdFx0XHRvcHRpb25zLiRib2R5LnJlbW92ZUNsYXNzKCdtb2RhbC1vcGVuJyk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c3dpdGNoUGFuZWw6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHRcdHZhciAkZWwgPSAkKHRoaXMpLnBhcmVudCgpLFxyXG5cdFx0XHRcdHBhbmVsID0gJGVsLmRhdGEoJ3BhbmVsJyk7XHJcblxyXG5cdFx0XHQkZWwuYWRkQ2xhc3MoJ2FjdGl2ZS1pdGVtLXNldHRpbmctdGFiJykuc2libGluZ3MoJy5hY3RpdmUtaXRlbS1zZXR0aW5nLXRhYicpLnJlbW92ZUNsYXNzKCdhY3RpdmUtaXRlbS1zZXR0aW5nLXRhYicpO1xyXG5cdFx0XHRvcHRpb25zLm9wZW5TZXR0aW5ncyhwYW5lbCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdHJlbmRlcjogZnVuY3Rpb24gKG1lbnVJdGVtKSB7XHJcblx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XHJcblxyXG5cdFx0XHQvLyBSZW5kZXIgbWVudVxyXG5cdFx0XHRvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtbWVnYS1tZW51LWl0ZW0tc2V0dGluZy10YWJzJykuaHRtbChvcHRpb25zLnRlbXBsYXRlcy5tZW51cyhvcHRpb25zLml0ZW1EYXRhKSk7XHJcblxyXG5cdFx0XHR2YXIgJG1lbnVQYW5lbHMgPSBvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtbWVnYS1tZW51LWl0ZW0tc2V0dGluZy10YWJzIC5wcC1tZWdhLW1lbnUtdG8tY29udGVudCcpO1xyXG5cclxuXHRcdFx0Ly8gUmVuZGVyIHRpdGxlXHJcblx0XHRcdHZhciB0aXRsZSA9ICQobWVudUl0ZW0pLnBhcmVudHMoJy5tZW51LWl0ZW0tc2V0dGluZ3MnKS5maW5kKCdpbnB1dC5lZGl0LW1lbnUtaXRlbS10aXRsZScpLnZhbCgpO1xyXG5cdFx0XHRvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtbWVnYS1tZW51LWl0ZW0taGVhZGVyLWJhcicpLmh0bWwob3B0aW9ucy50ZW1wbGF0ZXMudGl0bGUoe3RpdGxlOiB0aXRsZX0pKTtcclxuXHJcblx0XHRcdC8vIFJlbmRlciBjb250ZW50XHJcblx0XHRcdCRtZW51UGFuZWxzLmVhY2goZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRfdGhpcy5vcGVuU2V0dGluZ3MoJCh0aGlzKS5kYXRhKCdwYW5lbCcpKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cclxuXHRcdG9wZW5TZXR0aW5nczogZnVuY3Rpb24gKHBhbmVsKSB7XHJcblx0XHRcdHZhciAkY29udGVudCA9IG9wdGlvbnMuJG1vZGFsLmZpbmQoJy5wcC1tZW51LWl0ZW0tdGFiLWNvbnRlbnQnKSxcclxuXHRcdFx0XHQkcGFuZWwgPSAkY29udGVudC5jaGlsZHJlbignI2luc2lkZS0nICsgcGFuZWwpO1xyXG5cclxuXHRcdFx0aWYgKCRwYW5lbC5sZW5ndGgpIHtcclxuXHRcdFx0XHQkcGFuZWwuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHZhciAkdGFiUGFuZWwgPSBvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtbWVnYS1tZW51LWl0ZW0tc2V0dGluZy10YWJzIC5wcC1tZWdhLW1lbnUtdG8tY29udGVudFtkYXRhLXBhbmVsPScrcGFuZWwrJ10nKTtcclxuXHJcblx0XHRcdFx0JGNvbnRlbnQuYXBwZW5kKG9wdGlvbnMudGVtcGxhdGVzW3BhbmVsXShvcHRpb25zLml0ZW1EYXRhKSk7XHJcblxyXG5cdFx0XHRcdGlmICgkdGFiUGFuZWwuaGFzQ2xhc3MoJ2FjdGl2ZS1pdGVtLXNldHRpbmctdGFiJykpe1xyXG5cdFx0XHRcdFx0JGNvbnRlbnQuY2hpbGRyZW4oJyNpbnNpZGUtJyArIHBhbmVsKS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoJ21lZ2EnID09IHBhbmVsKSB7XHJcblx0XHRcdFx0XHRvcHRpb25zLmluaXRNZWdhQ29sdW1ucygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoJ2JhY2tncm91bmQnID09IHBhbmVsKSB7XHJcblx0XHRcdFx0XHRvcHRpb25zLmluaXRCYWNrZ3JvdW5kRmllbGRzKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICgnaWNvbicgPT0gcGFuZWwpIHtcclxuXHRcdFx0XHRcdG9wdGlvbnMuaW5pdEljb25GaWVsZHMoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cdFx0cmVzaXplTWVnYUNvbHVtbjogZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdFx0dmFyIHN0ZXBzID0gWycyMC4wMCUnLCAnMjUuMDAlJywgJzMzLjMzJScsICc1MC4wMCUnLCAnNjYuNjYlJywgJzc1LjAwJScsICcxMDAuMDAlJ10sXHJcblx0XHRcdFx0JGVsID0gJCh0aGlzKSxcclxuXHRcdFx0XHQkY29sdW1uID0gJGVsLmNsb3Nlc3QoJy5tZW51LWl0ZW0tY29udGFpbmVyJyksXHJcblx0XHRcdFx0d2lkdGggPSAkY29sdW1uLmRhdGEoJ3dpZHRoJyksXHJcblx0XHRcdFx0Y3VycmVudCA9IF8uaW5kZXhPZihzdGVwcywgd2lkdGgpLFxyXG5cdFx0XHRcdG5leHQ7XHJcblxyXG5cdFx0XHRpZiAoLTEgPT09IGN1cnJlbnQpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICgkZWwuaGFzQ2xhc3MoJ3N1Ym1lbnUtYmlnZ2VyJykpIHtcclxuXHRcdFx0XHRuZXh0ID0gY3VycmVudCA9PSBzdGVwcy5sZW5ndGggPyBjdXJyZW50IDogY3VycmVudCArIDE7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bmV4dCA9IGN1cnJlbnQgPT0gMCA/IGN1cnJlbnQgOiBjdXJyZW50IC0gMTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0JGNvbHVtblswXS5zdHlsZS53aWR0aCA9IHN0ZXBzW25leHRdO1xyXG5cdFx0XHQkY29sdW1uLmRhdGEoJ3dpZHRoJywgc3RlcHNbbmV4dF0pO1xyXG5cdFx0XHQkY29sdW1uLmZpbmQoJy5tZW51LWl0ZW0taGFuZGxlIC5tZW51LWl0ZW0td2lkdGgnKS52YWwoc3RlcHNbbmV4dF0pO1xyXG5cdFx0fSxcclxuXHJcblx0XHRpbml0TWVnYUNvbHVtbnM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyICRjb2x1bW5zID0gb3B0aW9ucy4kbW9kYWwuZmluZCgnI2luc2lkZS1tZWdhIC5tZW51LWl0ZW0tY29udGFpbmVyJyksXHJcblx0XHRcdFx0ZGVmYXVsdFdpZHRoID0gJzI1LjAwJSc7XHJcblxyXG5cdFx0XHRpZiAoISRjb2x1bW5zLmxlbmd0aCkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU3VwcG9ydCBtYXhpbXVtIDQgY29sdW1uc1xyXG5cdFx0XHRpZiAoJGNvbHVtbnMubGVuZ3RoIDwgNCkge1xyXG5cdFx0XHRcdGRlZmF1bHRXaWR0aCA9IFN0cmluZygoIDEwMCAvICRjb2x1bW5zLmxlbmd0aCApLnRvRml4ZWQoMikpICsgJyUnO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRfLmVhY2goJGNvbHVtbnMsIGZ1bmN0aW9uIChjb2x1bW4pIHtcclxuXHRcdFx0XHR2YXIgd2lkdGggPSBjb2x1bW4uZGF0YXNldC53aWR0aDtcclxuXHJcblx0XHRcdFx0d2lkdGggPSB3aWR0aCB8fCBkZWZhdWx0V2lkdGg7XHJcblxyXG5cdFx0XHRcdGNvbHVtbi5zdHlsZS53aWR0aCA9IHdpZHRoO1xyXG5cdFx0XHRcdGNvbHVtbi5kYXRhc2V0LndpZHRoID0gd2lkdGg7XHJcblx0XHRcdFx0JChjb2x1bW4pLmZpbmQoJy5tZW51LWl0ZW0taGFuZGxlIC5tZW51LWl0ZW0td2lkdGgnKS52YWwod2lkdGgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblxyXG5cdFx0aW5pdEJhY2tncm91bmRGaWVsZHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0b3B0aW9ucy4kbW9kYWwuZmluZCgnLmJhY2tncm91bmQtY29sb3ItcGlja2VyJykud3BDb2xvclBpY2tlcigpO1xyXG5cclxuXHRcdFx0Ly8gQmFja2dyb3VuZCBpbWFnZVxyXG5cdFx0XHRvcHRpb25zLiRtb2RhbC5vbignY2xpY2snLCAnLml0ZW0tbWVkaWEgLnVwbG9hZC1idXR0b24nLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHRcdFx0dmFyICRlbCA9ICQodGhpcyk7XHJcblxyXG5cdFx0XHRcdC8vIFJlbW92ZSBhbGwgYXR0YWNoZWQgJ3NlbGVjdCcgZXZlbnRcclxuXHRcdFx0XHRvcHRpb25zLmZyYW1lLm9mZignc2VsZWN0Jyk7XHJcblxyXG5cdFx0XHRcdC8vIFVwZGF0ZSBpbnB1dHMgd2hlbiBzZWxlY3QgaW1hZ2VcclxuXHRcdFx0XHRvcHRpb25zLmZyYW1lLm9uKCdzZWxlY3QnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgaW5wdXQgdmFsdWUgZm9yIHNpbmdsZSBpbWFnZSBzZWxlY3Rpb25cclxuXHRcdFx0XHRcdHZhciB1cmwgPSBvcHRpb25zLmZyYW1lLnN0YXRlKCkuZ2V0KCdzZWxlY3Rpb24nKS5maXJzdCgpLnRvSlNPTigpLnVybDtcclxuXHJcblx0XHRcdFx0XHQkZWwuc2libGluZ3MoJy50aHVtYm5haWwtaW1hZ2UnKS5odG1sKCc8aW1nIHNyYz1cIicgKyB1cmwgKyAnXCI+Jyk7XHJcblx0XHRcdFx0XHQkZWwuc2libGluZ3MoJ2lucHV0JykudmFsKHVybCk7XHJcblx0XHRcdFx0XHQkZWwuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG5cdFx0XHRcdFx0JGVsLnNpYmxpbmdzKCcucmVtb3ZlLWJ1dHRvbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0b3B0aW9ucy5mcmFtZS5vcGVuKCk7XHJcblx0XHRcdH0pLm9uKCdjbGljaycsICcuaXRlbS1tZWRpYSAucmVtb3ZlLWJ1dHRvbicsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdFx0XHR2YXIgJGVsID0gJCh0aGlzKTtcclxuXHJcblx0XHRcdFx0JGVsLnNpYmxpbmdzKCcudGh1bWJuYWlsLWltYWdlJykuaHRtbCgnJyk7XHJcblx0XHRcdFx0JGVsLnNpYmxpbmdzKCdpbnB1dCcpLnZhbCgnJyk7XHJcblx0XHRcdFx0JGVsLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuXHRcdFx0XHQkZWwuc2libGluZ3MoJy51cGxvYWQtYnV0dG9uJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEltYWdlIHR5cGVcclxuXHRcdFx0b3B0aW9ucy4kbW9kYWwub24oJ2NoYW5nZScsICcuaW1hZ2Utc2l6ZSBzZWxlY3QnLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyICRlbCA9ICQodGhpcyksXHJcblx0XHRcdFx0XHQkY29udGFpbmVyID0gJGVsLnBhcmVudHMoJy5pbnNpZGUtYmFja2dyb3VuZCcpO1xyXG5cclxuXHRcdFx0XHRpZiAoJ2JhY2tncm91bmQnID09ICRlbC52YWwoKSkge1xyXG5cdFx0XHRcdFx0JGNvbnRhaW5lci5maW5kKCcuYmFja2dyb3VuZC1wb3NpdGlvbiwgLmJhY2tncm91bmQtcmVwZWF0LCAuYmFja2dyb3VuZC1zaXplJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG5cdFx0XHRcdFx0JGNvbnRhaW5lci5maW5kKCcuaW1hZ2UtcG9zaXRpb24sIC5pbWFnZS1tYXJnaW4nKS5hZGRDbGFzcygnaGlkZGVuJyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCRjb250YWluZXIuZmluZCgnLmJhY2tncm91bmQtcG9zaXRpb24sIC5iYWNrZ3JvdW5kLXJlcGVhdCwgLmJhY2tncm91bmQtc2l6ZScpLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuXHRcdFx0XHRcdCRjb250YWluZXIuZmluZCgnLmltYWdlLXBvc2l0aW9uLCAuaW1hZ2UtbWFyZ2luJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGluaXRJY29uRmllbGRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHZhciAkaW5wdXQgPSBvcHRpb25zLiRtb2RhbC5maW5kKCcjcHAtaWNvbi1pbnB1dCcpLFxyXG5cdFx0XHRcdCRwcmV2aWV3ID0gb3B0aW9ucy4kbW9kYWwuZmluZCgnLnBwLWljb24tc2VsZWN0b3IgLnNlbGVjdGVkLWljb24nKSxcclxuXHRcdFx0XHQkaWNvbnMgPSBvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtaWNvbi1zZWxlY3RvciAuaWNvbnMtY29udGVudCBpJyk7XHJcblxyXG5cdFx0XHQvLyBTZWxlY3QgYW4gaWNvblxyXG5cdFx0XHRvcHRpb25zLiRtb2RhbC5vbignY2xpY2snLCAnLnBwLWljb24tc2VsZWN0b3IgLmljb25zLWNvbnRlbnQgc3BhbicsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR2YXIgJGVsID0gJCh0aGlzKSxcclxuXHRcdFx0XHRcdGljb24gPSAkZWwuZmluZCgnaScpLmRhdGEoJ2ljb24nKTtcclxuXHJcblx0XHRcdFx0JCgnLnBwLWljb24tc2VsZWN0b3IgLmljb25zLWNvbnRlbnQgc3Bhbi5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0JGVsLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcblx0XHRcdFx0JGlucHV0LnZhbChpY29uKTtcclxuXHRcdFx0XHQkcHJldmlldy5odG1sKCc8aSBjbGFzcz1cIicgKyBpY29uICsgJ1wiPjwvaT4nKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBEZWxldGUgdGhlIHNlbGVjdGVkIGljb25cclxuXHRcdFx0b3B0aW9ucy4kbW9kYWwub24oJ2NsaWNrJywgJy5wcC1pY29uLXNlbGVjdG9yIC5yZW1vdmUtaWNvbicsIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHQkcHJldmlldy5odG1sKCcnKTtcclxuXHRcdFx0XHQkaW5wdXQudmFsKCcnKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBUYWIgaWNvbnNcclxuXHRcdFx0b3B0aW9ucy4kbW9kYWwub24oJ2NsaWNrJywgJy5wcC1pY29uLXNlbGVjdG9yIC5pY29ucy10YWInLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyICRlbCA9ICQodGhpcyksXHJcblx0XHRcdFx0XHQkdGFyZ2V0ID0gJCgnLnBwLWljb24tc2VsZWN0b3IgLmljb25zLWNvbnRlbnQuJyArICRlbC5kYXRhKCd0YWInKSApO1xyXG5cclxuXHRcdFx0XHRpZiAoISRlbC5oYXNDbGFzcygnYWN0aXZlJykpe1xyXG5cdFx0XHRcdFx0JGVsLmFkZENsYXNzKCdhY3RpdmUnKS5zaWJsaW5ncygnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0XHRcdCR0YXJnZXQuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTZWFyY2ggZm9yIGljb25zXHJcblx0XHRcdG9wdGlvbnMuJG1vZGFsLm9uKCdrZXl1cCcsICcucHAtaWNvbi1zZWFyY2gnLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRcdHZhciB0ZXJtID0gJCh0aGlzKS52YWwoKS50b1VwcGVyQ2FzZSgpLFxyXG5cdFx0XHRcdFx0JGljb25Db250YWluZXIgPSAkaWNvbnMucGFyZW50KCk7XHJcblxyXG5cdFx0XHRcdGlmICghdGVybSkge1xyXG5cdFx0XHRcdFx0JGljb25Db250YWluZXIuc2hvdygpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkaWNvbkNvbnRhaW5lci5oaWRlKCkuZmlsdGVyKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuICQodGhpcykuZmluZCgnaScpLmRhdGEoJ2ljb24nKS50b1VwcGVyQ2FzZSgpLmluZGV4T2YodGVybSkgPiAtMTtcclxuXHRcdFx0XHRcdH0pLnNob3coKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHJcblx0XHRnZXRJdGVtRGF0YTogZnVuY3Rpb24gKG1lbnVJdGVtKSB7XHJcblx0XHRcdHZhciAkbWVudUl0ZW0gPSAkKG1lbnVJdGVtKS5jbG9zZXN0KCdsaS5tZW51LWl0ZW0nKSxcclxuXHRcdFx0XHQkbWVudURhdGEgPSAkbWVudUl0ZW0uZmluZCgnLnBwLWRhdGEnKSxcclxuXHRcdFx0XHRjaGlsZHJlbiA9ICRtZW51SXRlbS5jaGlsZE1lbnVJdGVtcygpO1xyXG5cclxuXHRcdFx0b3B0aW9ucy5pdGVtRGF0YSA9IHtcclxuXHRcdFx0XHRkZXB0aCAgICAgICAgICA6ICRtZW51SXRlbS5tZW51SXRlbURlcHRoKCksXHJcblx0XHRcdFx0bWVnYURhdGEgICAgICAgOiB7XHJcblx0XHRcdFx0XHRtZWdhICAgICAgICAgXHRcdDogJG1lbnVEYXRhLmRhdGEoJ21lZ2EnKSxcclxuXHRcdFx0XHRcdG1lZ2Ffd2lkdGggICBcdFx0OiAkbWVudURhdGEuZGF0YSgnbWVnYV93aWR0aCcpLFxyXG5cdFx0XHRcdFx0d2lkdGggICAgICAgIFx0XHQ6ICRtZW51RGF0YS5kYXRhKCd3aWR0aCcpLFxyXG5cdFx0XHRcdFx0YmFja2dyb3VuZCAgIFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdiYWNrZ3JvdW5kJyksXHJcblx0XHRcdFx0XHRpbWdfdHlwZVx0XHRcdDogJG1lbnVEYXRhLmRhdGEoJ2ltZ190eXBlJyksXHJcblx0XHRcdFx0XHRpbWdfc2l6ZVx0XHRcdDogJG1lbnVEYXRhLmRhdGEoJ2ltZ19zaXplJyksXHJcblx0XHRcdFx0XHRpbWdfcG9zXHRcdFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdpbWdfcG9zJyksXHJcblx0XHRcdFx0XHRpbWdfbm9fbWFyZ2luICBcdFx0OiAkbWVudURhdGEuZGF0YSgnaW1nX25vX21hcmdpbicpLFxyXG5cdFx0XHRcdFx0aWNvbiAgICAgICAgIFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdpY29uJyksXHJcblx0XHRcdFx0XHRpY29uX3BvcyAgICAgICBcdFx0OiAkbWVudURhdGEuZGF0YSgnaWNvbl9wb3MnKSxcclxuXHRcdFx0XHRcdGhpZGVfdGV4dCAgICAgXHRcdDogJG1lbnVEYXRhLmRhdGEoJ2hpZGVfdGV4dCcpLFxyXG5cdFx0XHRcdFx0aGlkZV9kZXNrdG9wICBcdFx0OiAkbWVudURhdGEuZGF0YSgnaGlkZV9kZXNrdG9wJyksXHJcblx0XHRcdFx0XHRoaWRlX21vYmlsZSAgIFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdoaWRlX21vYmlsZScpLFxyXG5cdFx0XHRcdFx0aGlkZV9pbWdfZGVza3RvcCAgXHQ6ICRtZW51RGF0YS5kYXRhKCdoaWRlX2ltZ19kZXNrdG9wJyksXHJcblx0XHRcdFx0XHRoaWRlX2ltZ19tb2JpbGUgIFx0OiAkbWVudURhdGEuZGF0YSgnaGlkZV9pbWdfbW9iaWxlJyksXHJcblx0XHRcdFx0XHRob3QgICAgICAgICAgXHRcdDogJG1lbnVEYXRhLmRhdGEoJ2hvdCcpLFxyXG5cdFx0XHRcdFx0dXBwZXJjYXNlX3RleHRcdFx0OiAkbWVudURhdGEuZGF0YSgndXBwZXJjYXNlX3RleHQnKSxcclxuXHRcdFx0XHRcdG5ldyAgICAgICAgICBcdFx0OiAkbWVudURhdGEuZGF0YSgnbmV3JyksXHJcblx0XHRcdFx0XHR0cmVuZGluZyAgICAgXHRcdDogJG1lbnVEYXRhLmRhdGEoJ3RyZW5kaW5nJyksXHJcblx0XHRcdFx0XHRzYWxlICAgICBcdFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdzYWxlJyksXHJcblx0XHRcdFx0XHRkaXNhYmxlX2xpbmsgIFx0XHQ6ICRtZW51RGF0YS5kYXRhKCdkaXNhYmxlX2xpbmsnKSxcclxuXHRcdFx0XHRcdGNvbnRlbnQgICAgICBcdFx0OiAkbWVudURhdGEuaHRtbCgpXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRkYXRhICAgICAgICAgICA6ICRtZW51SXRlbS5nZXRJdGVtRGF0YSgpLFxyXG5cdFx0XHRcdGNoaWxkcmVuICAgICAgIDogW10sXHJcblx0XHRcdFx0b3JpZ2luYWxFbGVtZW50OiAkbWVudUl0ZW0uZ2V0KDApXHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRpZiAoIV8uaXNFbXB0eShjaGlsZHJlbikpIHtcclxuXHRcdFx0XHRfLmVhY2goY2hpbGRyZW4sIGZ1bmN0aW9uIChpdGVtKSB7XHJcblx0XHRcdFx0XHR2YXIgJGl0ZW0gPSAkKGl0ZW0pLFxyXG5cdFx0XHRcdFx0XHQkaXRlbURhdGEgPSAkaXRlbS5maW5kKCcucHAtZGF0YScpLFxyXG5cdFx0XHRcdFx0XHRkZXB0aCA9ICRpdGVtLm1lbnVJdGVtRGVwdGgoKTtcclxuXHJcblx0XHRcdFx0XHRvcHRpb25zLml0ZW1EYXRhLmNoaWxkcmVuLnB1c2goe1xyXG5cdFx0XHRcdFx0XHRkZXB0aCAgICAgICAgICA6IGRlcHRoLFxyXG5cdFx0XHRcdFx0XHRzdWJEZXB0aCAgICAgICA6IGRlcHRoIC0gb3B0aW9ucy5pdGVtRGF0YS5kZXB0aCAtIDEsXHJcblx0XHRcdFx0XHRcdGRhdGEgICAgICAgICAgIDogJGl0ZW0uZ2V0SXRlbURhdGEoKSxcclxuXHRcdFx0XHRcdFx0bWVnYURhdGEgICAgICAgOiB7XHJcblx0XHRcdFx0XHRcdFx0bWVnYSAgICAgICAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdtZWdhJyksXHJcblx0XHRcdFx0XHRcdFx0bWVnYV93aWR0aCAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdtZWdhX3dpZHRoJyksXHJcblx0XHRcdFx0XHRcdFx0d2lkdGggICAgICAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCd3aWR0aCcpLFxyXG5cdFx0XHRcdFx0XHRcdGJhY2tncm91bmQgICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnYmFja2dyb3VuZCcpLFxyXG5cdFx0XHRcdFx0XHRcdGltZ190eXBlXHRcdCAgIFx0OiAkaXRlbURhdGEuZGF0YSgnaW1nX3R5cGUnKSxcclxuXHRcdFx0XHRcdFx0XHRpbWdfc2l6ZVx0XHQgICBcdDogJGl0ZW1EYXRhLmRhdGEoJ2ltZ19zaXplJyksXHJcblx0XHRcdFx0XHRcdFx0aW1nX3Bvc1x0XHQgICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnaW1nX3BvcycpLFxyXG5cdFx0XHRcdFx0XHRcdGltZ19ub19tYXJnaW4gIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdpbWdfbm9fbWFyZ2luJyksXHJcblx0XHRcdFx0XHRcdFx0aWNvbiAgICAgICAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdpY29uJyksXHJcblx0XHRcdFx0XHRcdFx0aWNvbl9wb3MgICAgICAgXHRcdDogJGl0ZW1EYXRhLmRhdGEoJ2ljb25fcG9zJyksXHJcblx0XHRcdFx0XHRcdFx0aGlkZV90ZXh0ICAgICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnaGlkZV90ZXh0JyksXHJcblx0XHRcdFx0XHRcdFx0aGlkZV9kZXNrdG9wICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnaGlkZV9kZXNrdG9wJyksXHJcblx0XHRcdFx0XHRcdFx0aGlkZV9tb2JpbGUgICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnaGlkZV9tb2JpbGUnKSxcclxuXHRcdFx0XHRcdFx0XHRoaWRlX2ltZ19kZXNrdG9wIFx0OiAkaXRlbURhdGEuZGF0YSgnaGlkZV9pbWdfZGVza3RvcCcpLFxyXG5cdFx0XHRcdFx0XHRcdGhpZGVfaW1nX21vYmlsZSAgIFx0OiAkaXRlbURhdGEuZGF0YSgnaGlkZV9pbWdfbW9iaWxlJyksXHJcblx0XHRcdFx0XHRcdFx0aG90ICAgICAgICAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdob3QnKSxcclxuXHRcdFx0XHRcdFx0XHR1cHBlcmNhc2VfdGV4dFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCd1cHBlcmNhc2VfdGV4dCcpLFxyXG5cdFx0XHRcdFx0XHRcdG5ldyAgICAgICAgICBcdFx0OiAkaXRlbURhdGEuZGF0YSgnbmV3JyksXHJcblx0XHRcdFx0XHRcdFx0dHJlbmRpbmcgICAgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCd0cmVuZGluZycpLFxyXG5cdFx0XHRcdFx0XHRcdHNhbGUgICAgIFx0XHRcdDogJGl0ZW1EYXRhLmRhdGEoJ3NhbGUnKSxcclxuXHRcdFx0XHRcdFx0XHRkaXNhYmxlX2xpbmsgIFx0XHQ6ICRpdGVtRGF0YS5kYXRhKCdkaXNhYmxlX2xpbmsnKSxcclxuXHRcdFx0XHRcdFx0XHRjb250ZW50ICAgICAgXHRcdDogJGl0ZW1EYXRhLmh0bWwoKVxyXG5cdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRvcmlnaW5hbEVsZW1lbnQ6IGl0ZW1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fSxcclxuXHJcblx0XHRzZXRJdGVtRGF0YTogZnVuY3Rpb24gKGl0ZW0sIGRhdGEsIGRlcHRoKSB7XHJcblx0XHRcdHZhciBjaGVja2JveGVzID0gWydtZWdhJywgJ2hpZGVfdGV4dCcsICd1cHBlcmNhc2VfdGV4dCcsICdkaXNhYmxlX2xpbmsnLCAnaW1nX25vX21hcmdpbicsICdoaWRlX2Rlc2t0b3AnLCAnaGlkZV9tb2JpbGUnLCAnaG90JywgJ25ldycsICd0cmVuZGluZycsICdzYWxlJywgJ2hpZGVfaW1nX2Rlc2t0b3AnLCAnaGlkZV9pbWdfbW9iaWxlJ107XHJcblxyXG5cdFx0XHQvLyBTZXQgdGhlIGNoZWNrYm94ZXMgdG8gZmFsc2UgaWYgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFcclxuXHRcdFx0JC5lYWNoKGNoZWNrYm94ZXMsIGZ1bmN0aW9uKGluZGV4LCB2YWx1ZSl7XHJcblx0XHRcdFx0aWYgKCFfLmhhcyhkYXRhLCB2YWx1ZSkpIHtcclxuXHRcdFx0XHRcdGRhdGFbdmFsdWVdID0gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHZhciAkZGF0YUhvbGRlciA9ICQoaXRlbSkuZmluZCgnLnBwLWRhdGEnKTtcclxuXHJcblx0XHRcdGlmIChfLmhhcyhkYXRhLCAnY29udGVudCcpKSB7XHJcblx0XHRcdFx0JGRhdGFIb2xkZXIuaHRtbChkYXRhLmNvbnRlbnQpO1xyXG5cdFx0XHRcdGRlbGV0ZSBkYXRhLmNvbnRlbnQ7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCRkYXRhSG9sZGVyLmRhdGEoZGF0YSk7XHJcblxyXG5cdFx0fSxcclxuXHJcblx0XHRnZXRGaWVsZE5hbWU6IGZ1bmN0aW9uIChuYW1lLCBpZCkge1xyXG5cdFx0XHRuYW1lID0gbmFtZS5zcGxpdCgnLicpO1xyXG5cdFx0XHRuYW1lID0gJ1snICsgbmFtZS5qb2luKCddWycpICsgJ10nO1xyXG5cclxuXHRcdFx0cmV0dXJuICdtZW51LWl0ZW1bJyArIGlkICsgJ10nICsgbmFtZTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c2F2ZUNoYW5nZXM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyIGRhdGEgPSBvcHRpb25zLiRtb2RhbC5maW5kKCcucHAtbWVudS1pdGVtLXRhYi1jb250ZW50IDppbnB1dCcpLnNlcmlhbGl6ZSgpLFxyXG5cdFx0XHRcdCRzcGlubmVyID0gb3B0aW9ucy4kbW9kYWwuZmluZCgnLnBwLW1lZ2EtbWVudS1pdGVtLWNvbnRyb2xzIC5zcGlubmVyJyk7XHJcblxyXG5cdFx0XHQkc3Bpbm5lci5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XHJcblxyXG5cdFx0XHQkLnBvc3QoYWpheHVybCwge1xyXG5cdFx0XHRcdGFjdGlvbjogJ3BwX3NhdmVfbWVudV9pdGVtX2RhdGEnLFxyXG5cdFx0XHRcdGRhdGEgIDogZGF0YVxyXG5cdFx0XHR9LCBmdW5jdGlvbiAocmVzKSB7XHJcblx0XHRcdFx0aWYgKCFyZXMuc3VjY2Vzcykge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dmFyIGRhdGEgPSByZXMuZGF0YVsnbWVudS1pdGVtJ107XHJcblxyXG5cdFx0XHRcdC8vIFVwZGF0ZSBwYXJlbnQgbWVudSBpdGVtXHJcblx0XHRcdFx0aWYgKF8uaGFzKGRhdGEsIG9wdGlvbnMuaXRlbURhdGEuZGF0YVsnbWVudS1pdGVtLWRiLWlkJ10pKSB7XHJcblx0XHRcdFx0XHRvcHRpb25zLnNldEl0ZW1EYXRhKG9wdGlvbnMuaXRlbURhdGEub3JpZ2luYWxFbGVtZW50LCBkYXRhW29wdGlvbnMuaXRlbURhdGEuZGF0YVsnbWVudS1pdGVtLWRiLWlkJ11dLCAwKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdF8uZWFjaChvcHRpb25zLml0ZW1EYXRhLmNoaWxkcmVuLCBmdW5jdGlvbiAobWVudUl0ZW0pIHtcclxuXHRcdFx0XHRcdGlmICghXy5oYXMoZGF0YSwgbWVudUl0ZW0uZGF0YVsnbWVudS1pdGVtLWRiLWlkJ10pKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRvcHRpb25zLnNldEl0ZW1EYXRhKG1lbnVJdGVtLm9yaWdpbmFsRWxlbWVudCwgZGF0YVttZW51SXRlbS5kYXRhWydtZW51LWl0ZW0tZGItaWQnXV0sIDEpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQkc3Bpbm5lci5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XHJcblx0XHRcdFx0b3B0aW9ucy5jbG9zZU1vZGFsKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdCQoZnVuY3Rpb24gKCkge1xyXG5cdFx0bWVudVNldHRpbmdzLmluaXQoKTtcclxuXHR9KTtcclxufSkoalF1ZXJ5LCBfKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
